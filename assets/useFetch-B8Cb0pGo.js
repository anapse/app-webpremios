import{b as r}from"./vendor-DJKrsZSW.js";function j(o,f={}){const{method:a="GET",headers:m={"Content-Type":"application/json"},body:d,timeoutMs:c=1e4}=f,[g,l]=r.useState(null),[h,n]=r.useState(!1),[b,s]=r.useState(null),T=r.useRef(null),u=r.useRef(0),p=()=>{u.current++,n(!0),s(null)};return r.useEffect(()=>{if(!o){n(!1),l(null),s(null);return}const e=new AbortController;T.current=e;const i=setTimeout(()=>e.abort("timeout"),c);async function E(){try{n(!0),s(null);const t=await fetch(o,{method:a,headers:m,body:d,signal:e.signal});if(!t.ok){const x=await t.text().catch(()=>"");throw new Error(`HTTP ${t.status}: ${t.statusText} ${x||""}`.trim())}const w=await t.json();e.signal.aborted||l(w)}catch(t){if(t?.name==="AbortError")return;e.signal.aborted||(console.error("❌ Fetch error:",t?.message||t,"→",o),s(t?.message||"Error de red"))}finally{clearTimeout(i),e.signal.aborted||n(!1)}}return E(),()=>{clearTimeout(i),e.abort("cleanup")}},[o,a,c,u.current]),{data:g,loading:h,error:b,refetch:p}}export{j as u};
