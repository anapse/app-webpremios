import{a as g,j as e}from"./index-BcMqhxv5.js";import{b as i}from"./vendor-DJKrsZSW.js";import{u as v}from"./useFetch-B8Cb0pGo.js";import"./pdf-C1-dEYVs.js";function S(){const[a,d]=i.useState(""),[c,l]=i.useState(""),[t,h]=i.useState("dni"),[n,u]=i.useState(!1),p=n?t==="dni"&&a?g.ticketsByDni(a):t==="codigo"&&c?g.ticketByCode(c):null:null,{data:r,loading:N,error:x}=v(p,{}),k=s=>{s.preventDefault(),(t==="dni"&&a.trim()||t==="codigo"&&c.trim())&&u(!0)},o=()=>{d(""),l(""),u(!1)},m=s=>new Date(s).toLocaleDateString("es-PE",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),j=s=>{switch(s?.toLowerCase()){case"pagado":case"completado":return"#28a745";case"pendiente":return"#ffc107";case"rechazado":case"fallido":return"#dc3545";default:return"#6c757d"}},f=()=>{if(!n)return null;if(N)return e.jsx("div",{className:"tickets-loading",children:e.jsx("p",{children:"🔍 Buscando tickets..."})});if(x)return e.jsxs("div",{className:"tickets-error",children:[e.jsxs("p",{children:["❌ Error al buscar tickets: ",x]}),e.jsx("button",{onClick:o,className:"btn-reset",children:"Intentar de nuevo"})]});if(t==="codigo"&&r){const s=r;return e.jsxs("div",{className:"tickets-results",children:[e.jsx("h3",{children:"🎟️ Ticket encontrado"}),e.jsxs("div",{className:"ticket-card",children:[e.jsxs("div",{className:"ticket-header",children:[e.jsx("h4",{children:s.codigo_ticket}),e.jsx("span",{className:"estado-badge",style:{backgroundColor:j(s.estado_pago)},children:s.estado_pago})]}),e.jsxs("div",{className:"ticket-info",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Nombre:"})," ",s.nombres]}),e.jsxs("p",{children:[e.jsx("strong",{children:"DNI/CE:"})," ",s.dni]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Teléfono:"})," ",s.telefono]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Departamento:"})," ",s.departamento]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Fecha:"})," ",m(s.fecha)]})]})]})]})}return t==="dni"&&Array.isArray(r)?r.length===0?e.jsxs("div",{className:"tickets-empty",children:[e.jsxs("p",{children:["🔍 No se encontraron tickets para el DNI/CE: ",a]}),e.jsx("button",{onClick:o,className:"btn-reset",children:"Nueva búsqueda"})]}):e.jsxs("div",{className:"tickets-results",children:[e.jsxs("h3",{children:["🎟️ Tickets encontrados (",r.length,")"]}),e.jsx("div",{className:"tickets-grid",children:r.map(s=>e.jsxs("div",{className:"ticket-card",children:[e.jsxs("div",{className:"ticket-header",children:[e.jsx("h4",{children:s.codigo_ticket}),e.jsx("span",{className:"estado-badge",style:{backgroundColor:j(s.estado_pago)},children:s.estado_pago})]}),e.jsxs("div",{className:"ticket-info",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Sorteo:"})," ",s.nombre_sorteo||`Sorteo #${s.sorteo_id}`]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Fecha:"})," ",m(s.fecha)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Estado:"})," ",s.estado_pago]})]})]},s.id))})]}):null};return e.jsx("div",{className:"tickets-page",children:e.jsxs("div",{className:"container",children:[e.jsxs("header",{className:"tickets-header",children:[e.jsx("h1",{children:"🎟️ Mis Tickets"}),e.jsx("p",{children:"Busca tus tickets por DNI/CE o código de ticket"})]}),e.jsxs("div",{className:"search-section",children:[e.jsxs("div",{className:"search-modes",children:[e.jsx("button",{className:`mode-btn ${t==="dni"?"active":""}`,onClick:()=>h("dni"),children:"Buscar por DNI / CE"}),e.jsx("button",{className:`mode-btn ${t==="codigo"?"active":""}`,onClick:()=>h("codigo"),children:"Buscar por Código"})]}),e.jsxs("form",{onSubmit:k,className:"search-form",children:[t==="dni"?e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"dni",children:"DNI o Carnet de Extranjería:"}),e.jsx("input",{type:"text",id:"dni",value:a,onChange:s=>d(s.target.value),placeholder:"Ingresa tu DNI o Carnet de Extranjería",maxLength:12,pattern:"[0-9]{8,12}",required:!0})]}):e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"codigo",children:"Código del Ticket:"}),e.jsx("input",{type:"text",id:"codigo",value:c,onChange:s=>l(s.target.value.toUpperCase()),placeholder:"Ej: GZP001TK0001",required:!0})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"btn-search",children:"🔍 Buscar Tickets"}),n&&e.jsx("button",{type:"button",onClick:o,className:"btn-reset",children:"Nueva búsqueda"})]})]})]}),f()]})})}export{S as default};
